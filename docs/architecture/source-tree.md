# Unified Project Structure

## Project Root

```
todo/
├── .github/                    # GitHub configuration
│   └── workflows/
│       ├── ci.yml             # CI: Run tests, linting
│       └── deploy.yml         # CD: Deploy to PythonAnywhere
│
├── docs/                       # Project documentation
│   ├── prd.md                 # Product Requirements Document
│   ├── architecture/          # Architecture documentation (sharded)
│   │   ├── introduction.md
│   │   ├── tech-stack.md
│   │   └── ...
│   └── api/                   # API documentation
│
├── todo_project/              # Django project directory
│   ├── __init__.py
│   ├── settings/              # Split settings
│   │   ├── __init__.py
│   │   ├── base.py           # Common settings
│   │   ├── development.py    # Local development
│   │   ├── production.py     # PythonAnywhere production
│   │   └── test.py           # Test environment
│   ├── urls.py               # Root URL configuration
│   ├── wsgi.py               # WSGI entry point
│   └── asgi.py               # ASGI entry point (future)
│
├── apps/                      # Django applications
│   ├── accounts/             # User management app
│   │   ├── __init__.py
│   │   ├── admin.py          # Django admin config
│   │   ├── apps.py           # App configuration
│   │   ├── models.py         # User model
│   │   ├── forms.py          # Login, registration forms
│   │   ├── views.py          # Auth views
│   │   ├── urls.py           # Account URLs
│   │   ├── tests/
│   │   │   ├── test_models.py
│   │   │   ├── test_views.py
│   │   │   └── test_forms.py
│   │   └── migrations/
│   │
│   ├── tasks/                # Core task management app
│   │   ├── __init__.py
│   │   ├── admin.py          # Task/Tag admin
│   │   ├── apps.py
│   │   ├── models.py         # Task, Tag models
│   │   ├── forms.py          # Task forms
│   │   ├── views.py          # Task CRUD views
│   │   ├── urls.py           # Task URLs
│   │   ├── serializers.py    # DRF serializers
│   │   ├── api_views.py      # API viewsets
│   │   ├── filters.py        # django-filter configs
│   │   ├── permissions.py    # Custom permissions
│   │   ├── tests/
│   │   │   ├── __init__.py
│   │   │   ├── factories.py  # Factory Boy factories
│   │   │   ├── test_models.py
│   │   │   ├── test_views.py
│   │   │   ├── test_api.py
│   │   │   └── test_e2e.py   # Playwright E2E tests
│   │   ├── templates/
│   │   │   └── tasks/
│   │   │       ├── task_list.html
│   │   │       ├── task_detail.html
│   │   │       ├── task_form.html
│   │   │       └── partials/
│   │   │           ├── task_item.html
│   │   │           └── tag_badge.html
│   │   └── migrations/
│   │
│   └── visualization/        # Network graph app
│       ├── __init__.py
│       ├── apps.py
│       ├── views.py          # Graph view
│       ├── api_views.py      # Graph data API
│       ├── urls.py
│       ├── graph_builder.py  # Graph data transformation
│       ├── tests/
│       │   ├── test_graph_builder.py
│       │   └── test_api.py
│       └── templates/
│           └── visualization/
│               └── graph.html
│
├── static/                    # Static assets (source)
│   ├── css/
│   │   ├── base.css          # Global styles
│   │   ├── tasks.css         # Task-specific styles
│   │   └── graph.css         # Visualization styles
│   ├── js/
│   │   ├── base.js           # Global JavaScript
│   │   ├── task-manager.js   # Task CRUD operations
│   │   ├── tag-autocomplete.js
│   │   └── graph-viewer.js   # vis-network integration
│   └── images/
│       ├── logo.svg
│       └── favicon.ico
│
├── staticfiles/               # Collected static files (production)
│   └── (generated by collectstatic)
│
├── templates/                 # Global templates
│   ├── base.html             # Base template (header, footer)
│   ├── home.html             # Landing page
│   ├── 404.html              # Error pages
│   ├── 500.html
│   └── includes/
│       ├── navbar.html
│       └── footer.html
│
├── media/                     # User-uploaded files (future)
│   └── (not used in MVP)
│
├── tests/                     # Project-wide integration tests
│   ├── __init__.py
│   ├── conftest.py           # Pytest configuration
│   ├── e2e/                  # Playwright E2E tests
│   │   ├── test_user_journey.py
│   │   └── test_graph_interaction.py
│   └── integration/
│       └── test_task_tag_workflow.py
│
├── scripts/                   # Utility scripts
│   ├── setup_dev.sh          # Development environment setup
│   ├── populate_test_data.py # Generate test tasks/tags
│   └── deploy.sh             # Deployment script
│
├── requirements/              # Dependency management
│   ├── base.in               # Core dependencies (source)
│   ├── base.txt              # Compiled core dependencies
│   ├── production.in         # Production-only (source)
│   ├── production.txt        # Compiled production
│   ├── development.in        # Development-only (source)
│   └── development.txt       # Compiled development
│
├── .gitignore                # Git ignore patterns
├── .env.example              # Environment variable template
├── .env                      # Local environment (not in git)
├── pyproject.toml            # Python project config (ruff, etc.)
├── pytest.ini                # Pytest configuration
├── manage.py                 # Django management script
├── README.md                 # Project documentation
└── LICENSE                   # License file
```

## Directory Descriptions

### Root Level

| Directory/File | Purpose |
|----------------|---------|
| `.github/` | GitHub Actions workflows for CI/CD |
| `docs/` | All project documentation (PRD, architecture, API) |
| `todo_project/` | Django project settings and configuration |
| `apps/` | Django applications (accounts, tasks, visualization) |
| `static/` | Source static files (CSS, JS, images) |
| `staticfiles/` | Collected static files for production (generated) |
| `templates/` | Global HTML templates |
| `media/` | User-uploaded files (not used in MVP) |
| `tests/` | Project-wide integration and E2E tests |
| `scripts/` | Utility scripts for setup and deployment |
| `requirements/` | Python dependency management with uv |
| `manage.py` | Django management command entry point |

### Application Structure (`apps/`)

Each Django app follows this pattern:

```
app_name/
├── __init__.py         # App initialization
├── apps.py             # App configuration
├── models.py           # Data models
├── admin.py            # Django admin configuration
├── views.py            # Django views (server-rendered)
├── api_views.py        # DRF API views
├── serializers.py      # DRF serializers
├── forms.py            # Django forms
├── urls.py             # URL routing
├── permissions.py      # Custom permissions
├── filters.py          # django-filter configurations
├── tests/              # App-specific tests
│   ├── __init__.py
│   ├── factories.py    # Factory Boy test data
│   ├── test_models.py
│   ├── test_views.py
│   └── test_api.py
├── templates/          # App-specific templates
│   └── app_name/
│       └── *.html
└── migrations/         # Database migrations
```

### Settings Structure (`todo_project/settings/`)

Split settings for different environments:

**`base.py`**: Common settings for all environments
- Installed apps
- Middleware
- Database configuration (from environment variables)
- Static files configuration
- Template settings

**`development.py`**: Local development
- `DEBUG = True`
- Django Debug Toolbar
- Local database
- Verbose logging

**`production.py`**: PythonAnywhere production
- `DEBUG = False`
- Security settings (SECURE_SSL_REDIRECT, etc.)
- Sentry integration
- Production database
- WhiteNoise static files

**`test.py`**: Test environment
- In-memory database (SQLite)
- Faster password hashing
- Disable migrations (if needed)

### Static Files Organization

```
static/
├── css/
│   ├── base.css           # Global styles, CSS variables
│   ├── tasks.css          # Task list, forms, cards
│   ├── graph.css          # Network graph visualization
│   └── admin-overrides.css # Django admin customization
│
├── js/
│   ├── base.js            # Global utilities, CSRF setup
│   ├── task-manager.js    # Task CRUD, Alpine.js components
│   ├── tag-autocomplete.js # Tag input with autocomplete
│   ├── graph-viewer.js    # vis-network initialization
│   └── vendor/            # Third-party libraries
│       ├── alpine.min.js
│       └── vis-network.min.js
│
└── images/
    ├── logo.svg
    ├── favicon.ico
    └── icons/
        ├── task-icon.svg
        └── tag-icon.svg
```

### Template Organization

```
templates/
├── base.html              # Master template (all pages extend this)
├── home.html              # Landing page
├── 404.html               # Not found error page
├── 500.html               # Server error page
│
├── includes/              # Reusable template fragments
│   ├── navbar.html        # Top navigation bar
│   ├── footer.html        # Footer
│   ├── messages.html      # Django messages display
│   └── pagination.html    # Pagination controls
│
├── accounts/              # Account templates (in apps/accounts/templates/)
│   ├── login.html
│   ├── register.html
│   ├── profile.html
│   └── password_reset.html
│
├── tasks/                 # Task templates (in apps/tasks/templates/)
│   ├── task_list.html     # Main task list view
│   ├── task_detail.html   # Single task view
│   ├── task_form.html     # Create/edit task
│   └── partials/          # AJAX-loaded fragments
│       ├── task_item.html
│       └── tag_badge.html
│
└── visualization/         # Graph templates (in apps/visualization/templates/)
    └── graph.html         # Network graph view
```

### Test Organization

```
tests/
├── conftest.py            # Pytest fixtures (global)
│   # - Authenticated client
│   # - Test database setup
│   # - Factory defaults
│
├── e2e/                   # Playwright end-to-end tests
│   ├── conftest.py        # Playwright fixtures
│   ├── test_user_journey.py
│   │   # - Test: Create account → Add tasks → Visualize graph
│   ├── test_graph_interaction.py
│   │   # - Test: Click nodes, filter graph, drag tasks
│   └── test_mobile.py     # Mobile-specific tests
│
└── integration/           # Cross-app integration tests
    ├── test_task_tag_workflow.py
    │   # - Test: Create task → Add tags → Verify graph
    └── test_permissions.py
        # - Test: User isolation (can't see others' tasks)
```

### App-Specific Tests

```
apps/tasks/tests/
├── __init__.py
├── factories.py           # Factory Boy factories
│   # - UserFactory
│   # - TaskFactory
│   # - TagFactory
│
├── test_models.py         # Model tests
│   # - Test: Task validation
│   # - Test: Tag uniqueness per user
│   # - Test: is_overdue property
│
├── test_views.py          # View tests
│   # - Test: Task list pagination
│   # - Test: Create task form
│   # - Test: User isolation
│
└── test_api.py            # API tests
    # - Test: GET /api/tasks/ returns user's tasks
    # - Test: POST /api/tasks/ creates task
    # - Test: Cannot access other users' tasks
```

## Configuration Files

### `pyproject.toml` (Python Project Configuration)

```toml
[project]
name = "django-todo-app"
version = "1.0.0"
description = "To-Do Application with Network Graph Visualization"
requires-python = ">=3.10"

[tool.ruff]
line-length = 88
target-version = "py310"

[tool.ruff.lint]
select = [
    "E",      # pycodestyle errors
    "W",      # pycodestyle warnings
    "F",      # pyflakes
    "I",      # isort
    "DJ",     # flake8-django
    "N",      # pep8-naming
    "UP",     # pyupgrade
]
ignore = ["E501"]  # Let formatter handle line length

[tool.ruff.lint.per-file-ignores]
"**/migrations/*.py" = ["E501", "DJ01"]
"**/tests/*.py" = ["S101"]

[tool.pytest.ini_options]
DJANGO_SETTINGS_MODULE = "todo_project.settings.test"
python_files = ["test_*.py", "*_test.py"]
python_classes = ["Test*"]
python_functions = ["test_*"]
addopts = "--cov=apps --cov-report=html --cov-report=term"
testpaths = ["apps", "tests"]
```

### `pytest.ini` (Pytest Configuration)

```ini
[pytest]
DJANGO_SETTINGS_MODULE = todo_project.settings.test
python_files = tests.py test_*.py *_tests.py
addopts =
    --cov=apps
    --cov-report=html
    --cov-report=term-missing
    --reuse-db
    --tb=short
```

### `.env.example` (Environment Variables Template)

```bash
# Django Configuration
SECRET_KEY=your-secret-key-here
DEBUG=True
ALLOWED_HOSTS=localhost,127.0.0.1

# Database Configuration
DATABASE_URL=postgresql://user:password@localhost:5432/todo_db

# Email Configuration (for password reset)
EMAIL_BACKEND=django.core.mail.backends.console.EmailBackend
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=
EMAIL_HOST_PASSWORD=

# Sentry (Production)
SENTRY_DSN=

# PythonAnywhere (Production)
PYTHONANYWHERE_USERNAME=
PYTHONANYWHERE_API_TOKEN=
```

### `.gitignore`

```
# Python
*.py[cod]
__pycache__/
*.so
.Python
env/
venv/
.venv/

# Django
*.log
db.sqlite3
db.sqlite3-journal
media/
staticfiles/
.env

# IDE
.vscode/
.idea/
*.swp
*.swo

# Testing
.coverage
htmlcov/
.pytest_cache/
.tox/

# OS
.DS_Store
Thumbs.db
```

## Import Path Conventions

### Absolute Imports (Preferred)

```python
# Good: Absolute imports from project root
from apps.tasks.models import Task, Tag
from apps.accounts.models import User
from todo_project.settings import base
```

### Relative Imports (Within App)

```python
# Good: Relative imports within same app
from .models import Task
from .serializers import TaskSerializer
from ..accounts.models import User  # From sibling app
```

## File Naming Conventions

| Type | Convention | Example |
|------|------------|---------|
| Python modules | snake_case | `task_manager.py` |
| Python classes | PascalCase | `TaskSerializer` |
| Python functions | snake_case | `get_user_tasks()` |
| Templates | kebab-case | `task-list.html` |
| Static files | kebab-case | `task-manager.js` |
| Test files | test_*.py | `test_models.py` |
| Migrations | auto-generated | `0001_initial.py` |

## URL Naming Conventions

```python
# apps/tasks/urls.py
urlpatterns = [
    path('', views.task_list, name='task-list'),
    path('create/', views.task_create, name='task-create'),
    path('<uuid:pk>/', views.task_detail, name='task-detail'),
    path('<uuid:pk>/edit/', views.task_update, name='task-update'),
    path('<uuid:pk>/delete/', views.task_delete, name='task-delete'),
]

# API URLs
api_urlpatterns = [
    path('tasks/', TaskViewSet.as_view({'get': 'list', 'post': 'create'})),
    path('tasks/<uuid:pk>/', TaskViewSet.as_view({
        'get': 'retrieve',
        'put': 'update',
        'patch': 'partial_update',
        'delete': 'destroy'
    })),
]
```

**URL Name Pattern**: `{model}-{action}`
- task-list, task-detail, task-create, task-update, task-delete
- tag-list, tag-detail, tag-create, etc.

## Database Migration Naming

Auto-generated by Django:
- `0001_initial.py` - Initial models
- `0002_add_task_priority.py` - Descriptive changes
- `0003_alter_tag_color.py` - Field alterations

Custom data migrations:
- `0004_populate_default_tags.py` - Data population
- `0005_migrate_legacy_tasks.py` - Data transformation

## Script Naming

| Script | Purpose |
|--------|---------|
| `setup_dev.sh` | Local development environment setup |
| `populate_test_data.py` | Generate test tasks and tags |
| `deploy.sh` | Production deployment to PythonAnywhere |
| `backup_db.sh` | Database backup script |
| `run_tests.sh` | Run full test suite with coverage |
